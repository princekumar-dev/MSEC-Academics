import{c as ue,j as e,F as H,a,X as xe,u as pe}from"./index-d35fa7e7.js";import{r as d,u as ge}from"./react-vendor-07fa9950.js";import{u as fe}from"./Confetti-eb26a331.js";import{H as be}from"./ContextualHelp-7deaab06.js";import{d as ye}from"./resultUtils-190b400a.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],we=ue("rotate-ccw",ve);function Ne({rows:y=5,columns:p=6}){return e("div",{className:"space-y-3",children:[...Array(y)].map((g,c)=>e("div",{className:"flex gap-4 animate-pulse",children:[...Array(p)].map((j,h)=>e("div",{className:"h-12 bg-gray-200 rounded-lg",style:{width:h===0?"5%":h===1?"25%":h===2?"20%":h===3?"15%":h===4?"20%":"15%"}},h))},c))})}function ke({message:y,onUndo:p,duration:g=5e3,onClose:c}){const[j,h]=d.useState(100);return d.useEffect(()=>{const S=setInterval(()=>{h(E=>E<=0?(clearInterval(S),c==null||c(),0):E-100/(g/100))},100);return()=>clearInterval(S)},[g,c]),e("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 animate-slide-up",children:a("div",{className:"bg-gray-900 text-white rounded-xl shadow-2xl overflow-hidden min-w-[320px] max-w-md",children:[a("div",{className:"px-4 py-3 flex items-center justify-between gap-3",children:[a("div",{className:"flex items-center gap-3 flex-1",children:[e("div",{className:"w-8 h-8 bg-white/10 rounded-full flex items-center justify-center flex-shrink-0",children:e(we,{className:"w-4 h-4"})}),e("p",{className:"text-sm font-medium",children:y})]}),a("div",{className:"flex items-center gap-2",children:[p&&e("button",{onClick:()=>{p(),c==null||c()},className:"px-3 py-1.5 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg text-sm font-semibold transition-colors",children:"Undo"}),e("button",{onClick:c,className:"p-1 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Close",children:e(xe,{className:"w-4 h-4"})})]})]}),e("div",{className:"h-1 bg-white/10",children:e("div",{className:"h-full bg-yellow-500 transition-all duration-100 ease-linear",style:{width:`${j}%`}})})]})})}function Ie(){const[y,p]=d.useState(null),g=(h,S)=>{p({message:h,undoAction:S})},c=()=>p(null);return{showUndo:g,hideToast:c,ToastContainer:()=>e(H,{children:y&&e(ke,{message:y.message,onUndo:y.undoAction,onClose:c})})}}function Ve(){var B,W;const y=ge(),{showSuccess:p,showError:g,showInfo:c}=pe(),{showUndo:j,ToastContainer:h}=Ie(),{celebrate:S,ConfettiContainer:E}=fe(),[n,G]=d.useState(()=>{const t=localStorage.getItem("auth");return t?JSON.parse(t):null}),[m,X]=d.useState([]),[K,Q]=d.useState(!0),[A,$]=d.useState(null),[v,C]=d.useState(!1),[T,Y]=d.useState(""),[L,f]=d.useState([]),[w,I]=d.useState(!1),[q,O]=d.useState(!1),[l,_]=d.useState({examinationName:"",semester:"",year:"",academicYear:"",examinationMonth:"",examinationYear:new Date().getFullYear().toString()}),[P,Z]=d.useState(!1),[x,D]=d.useState(null),[M,ee]=d.useState({}),[b,te]=d.useState(null),[Se,ae]=d.useState([]),F={verified_by_staff:"bg-blue-100 text-blue-800",dispatch_requested:"bg-yellow-100 text-yellow-800",rescheduled_by_hod:"bg-orange-100 text-orange-800",approved_by_hod:"bg-green-100 text-green-800",rejected_by_hod:"bg-red-100 text-red-800",dispatched:"bg-purple-100 text-purple-800"},se={verified_by_staff:"ðŸ“‹",dispatch_requested:"â³",rescheduled_by_hod:"ðŸ”„",approved_by_hod:"âœ…",rejected_by_hod:"â›”",dispatched:"ðŸ“¤"};d.useEffect(()=>{n&&n.role==="staff"&&(V(),R())},[n]),d.useEffect(()=>{const t=m.reduce((s,r)=>{const i=r.examinationName||"Unknown Examination";return s[i]||(s[i]=[]),s[i].push(r),s},{});Object.keys(t).forEach(s=>{t[s].sort((r,i)=>{var k,z;const o=(((k=r.studentDetails)==null?void 0:k.regNumber)||"").toString().toLowerCase(),u=(((z=i.studentDetails)==null?void 0:z.regNumber)||"").toString().toLowerCase();return o.localeCompare(u,void 0,{numeric:!0,sensitivity:"base"})})}),ee(t)},[m]);const U=()=>{try{const t=localStorage.getItem("auth");if(t){const s=JSON.parse(t);return G(s),s}}catch(t){console.error("Error refreshing user data:",t)}return n},N=t=>{const s=t?M[t]:m;return!s||s.length===0?!1:s.every(r=>r.status==="verified_by_staff"||r.status==="dispatch_requested"||r.status==="approved_by_hod"||r.status==="dispatched")},V=async()=>{try{const t=(n==null?void 0:n._id)||(n==null?void 0:n.id)||localStorage.getItem("userId"),r=await(await fetch(`/api/marksheets?staffId=${t}`)).json();r.success&&X(r.marksheets)}catch(t){console.error("Error fetching marksheets:",t)}finally{Q(!1)}},R=async()=>{try{const t=(n==null?void 0:n._id)||(n==null?void 0:n.id)||localStorage.getItem("userId"),r=await(await fetch(`/api/examinations?staffId=${t}`)).json();r.success&&ae(r.examinations)}catch(t){console.error("Error fetching examinations:",t)}},re=t=>{t.target.files&&t.target.files[0]&&$(t.target.files[0])},ne=async()=>{if(!l.examinationName||!l.semester||!l.year||!l.academicYear||!l.examinationMonth||!l.examinationYear){f(["Please fill in all examination details"]);return}C(!0),f([]);try{const t=n._id||n.id||localStorage.getItem("userId"),s=await fetch("/api/examinations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({examinationName:l.examinationName,year:l.year,semester:l.semester,academicYear:l.academicYear,examinationMonth:l.examinationMonth,examinationYear:l.examinationYear,staffId:t})}),r=await s.json();if(!s.ok||!r.success){f([r.error||"Failed to create examination"]);return}te(r.examination),Z(!0),O(!1),await R()}catch(t){console.error("Error creating examination:",t),f([t.message||"Failed to create examination"])}finally{C(!1)}},ie=async()=>{if(A){C(!0),f([]),Y("");try{const t=new FormData;t.append("excelFile",A),t.append("staffId",n._id||n.id||localStorage.getItem("userId"));const s=new Date(`${l.examinationYear}-${String(l.examinationMonth).padStart(2,"0")}-01`);t.append("examinationDate",s.toISOString()),t.append("examinationName",l.examinationName),t.append("semester",l.semester),t.append("department",n.department),t.append("year",n.year);const r=await fetch("/api/import-excel?action=upload",{method:"POST",body:t}),i=await r.json();!r.ok||!i.success?f([i.error||"Upload failed"]):(Y(i.sessionId),f(i.errorMessages||[]))}catch(t){f([t.message||"Unexpected error"])}finally{C(!1)}}},le=async()=>{if(T){C(!0);try{const t=await fetch("/api/import-excel?action=confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:T})}),s=await t.json();!t.ok||!s.success?f([s.error||"Confirm failed"]):(await V(),Y(""),$(null))}catch(t){f([t.message||"Unexpected error"])}finally{C(!1)}}},J=async()=>{if(!(!m||m.length===0)){I(!0);try{const t=m.filter(i=>i.status!=="verified_by_staff");if(t.length===0){c("Already Verified","All marksheets are already verified"),I(!1);return}const s=U();if(!(s!=null&&s.eSignature)){g("Signature Required","Please upload your signature in Settings before verifying marksheets"),I(!1);return}const r=s.eSignature;await Promise.all(t.map(async i=>{try{await(await fetch("/api/marksheets?action=verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({marksheetId:i._id,staffSignature:r})})).json().catch(()=>({}))}catch{}})),await V(),p("âœ“ All Verified",`Successfully verified ${t.length} marksheet${t.length>1?"s":""}`),S()}catch{g("Verification Failed","Could not verify all marksheets")}finally{I(!1)}}},oe=async()=>{if(!(!m||m.length===0)){I(!0);try{const t=m.filter(i=>i.status!=="verified_by_staff");if(t.length===0){c("Already Complete","All marksheets are already verified"),I(!1);return}const s=U();if(!(s!=null&&s.eSignature)){g("Signature Required","Please upload your signature in Settings before verifying marksheets"),I(!1);return}const r=s.eSignature;await Promise.all(t.map(async i=>{try{const o=await fetch("/api/marksheets?action=verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({marksheetId:i._id,staffSignature:r})}),u=await o.json().catch(()=>({}));if(o.ok&&u&&u.success)try{await fetch("/api/marksheets?action=request-dispatch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({marksheetId:i._id,staffId:n==null?void 0:n.id})})}catch{}}catch{}})),await V(),p("âœ“ Verified & Requested",`${t.length} marksheet${t.length>1?"s":""} verified and dispatch requested`),S()}catch{g("Action Failed","Could not complete verification and dispatch request")}finally{I(!1)}}};if(!n||n.role!=="staff")return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:a("div",{className:"glass-card p-8 rounded-3xl text-center",children:[e("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e("p",{className:"text-gray-600",children:"Only staff members can view marksheets."})]})});if(K)return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 px-4 py-6 sm:px-6 lg:px-8",children:a("div",{className:"max-w-7xl mx-auto",children:[a("div",{className:"mb-6",children:[e("div",{className:"w-48 h-8 bg-gray-200 rounded-lg animate-pulse mb-2"}),e("div",{className:"w-64 h-4 bg-gray-100 rounded animate-pulse"})]}),e(Ne,{rows:8,columns:6})]})});const de=m.length,ce=m.filter(t=>t.status==="verified_by_staff"||t.status==="dispatch_requested"||t.status==="rescheduled_by_hod"||t.status==="approved_by_hod"||t.status==="dispatched").length,me=m.filter(t=>t.status==="dispatch_requested").length,he=m.filter(t=>t.status==="dispatched").length;return a("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 no-mobile-anim",children:[e("div",{className:"responsive-container py-6 md:py-8",children:a("div",{className:"max-w-7xl mx-auto",children:[e("div",{className:"mb-6 md:mb-8",children:e("div",{className:"glass-card no-mobile-backdrop responsive-spacing rounded-3xl",children:a("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a("div",{children:[e("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-black text-[#111418] mb-2",children:"Marksheets"}),a("p",{className:"text-base sm:text-lg text-gray-600",children:["Manage marksheets for ",n.department," Department - Class ",n.year,"-",n.section]})]}),a("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap gap-2 sm:gap-3",children:[a("div",{className:"glass-card px-3 py-2 rounded-xl text-center sm:text-left",children:[e("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:"Total Marksheets"}),e("div",{className:"text-lg sm:text-xl md:text-2xl font-bold text-theme-gold-600",children:de})]}),a("div",{className:"glass-card px-3 py-2 rounded-xl text-center sm:text-left",children:[e("div",{className:"text-xs text-gray-500",children:"Verified"}),e("div",{className:"text-lg sm:text-xl md:text-2xl font-bold text-green-600",children:ce})]}),a("div",{className:"glass-card px-3 py-2 rounded-xl text-center sm:text-left",children:[e("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:"Dispatch Requested"}),e("div",{className:"text-lg sm:text-xl md:text-2xl font-bold text-yellow-600",children:me})]}),a("div",{className:"glass-card px-3 py-2 rounded-xl text-center sm:text-left",children:[e("div",{className:"text-xs text-gray-500",children:"Dispatched"}),e("div",{className:"text-lg sm:text-xl md:text-2xl font-bold text-purple-600",children:he})]})]})]})})}),a("div",{className:"glass-card p-8 rounded-3xl mb-8",children:[!q&&!P&&!x&&e("div",{className:"text-center mb-8",children:a("button",{onClick:()=>O(!0),className:"inline-flex items-center gap-2 px-4 sm:px-8 py-2 sm:py-4 bg-blue-600 text-white rounded-xl font-semibold text-sm sm:text-lg hover:bg-blue-700 transition-colors shadow-lg",children:[e("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create New Marksheet"]})}),q&&a("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-8",children:[e("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Create New Examination"}),a("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Examination Name"}),e("input",{type:"text",placeholder:"e.g., Mid Term, Final Exam, Unit Test 1",value:l.examinationName,onChange:t=>_(s=>({...s,examinationName:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),a("select",{value:l.year,onChange:t=>_(s=>({...s,year:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select Year"}),e("option",{value:"I",children:"I"}),e("option",{value:"II",children:"II"}),e("option",{value:"III",children:"III"}),e("option",{value:"IV",children:"IV"})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Semester"}),a("select",{value:l.semester,onChange:t=>_(s=>({...s,semester:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select Semester"}),e("option",{value:"I",children:"I"}),e("option",{value:"II",children:"II"}),e("option",{value:"III",children:"III"}),e("option",{value:"IV",children:"IV"}),e("option",{value:"V",children:"V"}),e("option",{value:"VI",children:"VI"}),e("option",{value:"VII",children:"VII"}),e("option",{value:"VIII",children:"VIII"})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),e("input",{type:"text",placeholder:"e.g., 2024-25",value:l.academicYear,onChange:t=>_(s=>({...s,academicYear:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Examination Month"}),a("select",{value:l.examinationMonth,onChange:t=>_(s=>({...s,examinationMonth:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select Month"}),e("option",{value:"1",children:"January"}),e("option",{value:"2",children:"February"}),e("option",{value:"3",children:"March"}),e("option",{value:"4",children:"April"}),e("option",{value:"5",children:"May"}),e("option",{value:"6",children:"June"}),e("option",{value:"7",children:"July"}),e("option",{value:"8",children:"August"}),e("option",{value:"9",children:"September"}),e("option",{value:"10",children:"October"}),e("option",{value:"11",children:"November"}),e("option",{value:"12",children:"December"})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Examination Year"}),e("input",{type:"number",value:l.examinationYear,onChange:t=>_(s=>({...s,examinationYear:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"2020",max:"2030"})]})]}),a("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4 mt-6",children:[e("button",{onClick:ne,disabled:v,className:`flex-1 sm:flex-none px-4 sm:px-6 py-2.5 sm:py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-sm sm:text-base ${v?"opacity-60 cursor-not-allowed":""}`,children:v?"Creating...":"Create & Continue to Import"}),e("button",{onClick:()=>O(!1),className:"flex-1 sm:flex-none px-4 sm:px-6 py-2.5 sm:py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors text-sm sm:text-base",children:"Cancel"})]})]}),P&&a(H,{children:[a("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-6",children:[a("div",{className:"flex items-center gap-2 mb-3",children:[e("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e("h3",{className:"font-semibold text-green-900",children:"Examination Created Successfully"})]}),b&&a("div",{className:"bg-white rounded-lg p-4 border border-green-100 mb-4",children:[a("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a("div",{children:[e("strong",{children:"Name:"})," ",b.examinationName]}),a("div",{children:[e("strong",{children:"Year:"})," ",b.year]}),a("div",{children:[e("strong",{children:"Semester:"})," ",b.semester]}),a("div",{children:[e("strong",{children:"Academic Year:"})," ",b.academicYear]}),a("div",{children:[e("strong",{children:"Month:"})," ",new Date(2e3,b.examinationMonth-1).toLocaleString("default",{month:"long"})]}),a("div",{children:[e("strong",{children:"Exam Year:"})," ",b.examinationYear]})]}),a("div",{className:"mt-3 pt-3 border-t border-green-100 text-xs text-gray-600",children:[a("div",{children:[e("strong",{children:"Examination ID:"})," ",b._id]}),a("div",{children:[e("strong",{children:"Created:"})," ",new Date(b.createdAt).toLocaleString()]}),a("div",{children:[e("strong",{children:"Status:"})," ",e("span",{className:"capitalize font-medium text-green-600",children:b.status})]})]})]}),e("p",{className:"text-sm text-green-800",children:"You can now import student marks for this examination using the Excel template below."})]}),a("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:[e("h4",{className:"font-semibold text-yellow-900 mb-2",children:"ðŸ“‹ Required Excel Format:"}),e("p",{className:"text-sm text-yellow-800 mb-2",children:"Your Excel file should contain the following columns in this exact order:"}),e("div",{className:"bg-white rounded-lg p-3 font-mono text-xs border",children:"Name | RegNumber | Year | Section | ParentPhone | Mathematics | Physics | Chemistry | Computer | English | ..."}),a("p",{className:"text-xs text-yellow-700 mt-2",children:["â€¢ First 5 columns are required student details",e("br",{}),"â€¢ Remaining columns are subject names with their marks",e("br",{}),"â€¢ Marks should be numeric values (0-100)"]})]}),a("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-6",children:[a("div",{className:"w-full sm:w-auto flex items-center",children:[e("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:re,className:"hidden",id:"excelFileMarksheets"}),a("label",{htmlFor:"excelFileMarksheets",className:"glass-button inline-flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 text-green-600 rounded-xl sm:rounded-2xl font-bold text-sm sm:text-lg transition-colors duration-300 cursor-pointer w-full justify-center sm:justify-start",children:[e("svg",{className:"w-4 sm:w-5 h-4 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e("span",{className:"hidden sm:inline",children:"Import Excel"}),e("span",{className:"sm:hidden",children:"Import"})]})]}),a("a",{href:"/api/demo-excel",className:"glass-button inline-flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 text-gray-600 rounded-xl sm:rounded-2xl font-bold text-sm sm:text-lg transition-colors duration-300 w-full sm:w-auto justify-center",children:[e("svg",{className:"w-4 sm:w-5 h-4 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e("span",{className:"hidden sm:inline",children:"Download Template"}),e("span",{className:"sm:hidden",children:"Template"})]}),A&&e("div",{className:"w-full sm:w-auto",children:e("button",{disabled:v,onClick:ie,className:`w-full sm:w-auto inline-flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-blue-600 text-white rounded-xl sm:rounded-2xl font-bold text-sm sm:text-lg transition-colors duration-300 shadow-md hover:shadow-lg justify-center ${v?"opacity-60":""}`,children:v?"Uploading...":"Upload"})}),T&&e("button",{onClick:le,disabled:v,className:`w-full sm:w-auto inline-flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-green-600 text-white rounded-xl sm:rounded-2xl font-bold text-sm sm:text-lg transition-colors duration-300 shadow-md hover:shadow-lg justify-center ${v?"opacity-60":""}`,children:v?"Processing...":"Confirm Import"}),a("div",{className:"flex items-center gap-2 w-full sm:w-auto sm:ml-auto",children:[e("button",{onClick:J,disabled:w||N(null),className:`flex-1 sm:flex-initial inline-flex justify-center items-center gap-2 px-4 sm:px-5 py-2 sm:py-3 rounded-xl font-semibold text-sm sm:text-base transition-colors duration-200 ${w||N(null)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 hover:shadow-md"}`,children:N(null)?"âœ“ All Verified":w?"Verifying...":"Verify All"}),e(be,{content:"Verify all unverified marksheets at once. This will mark them as verified by staff."})]})]})]}),L&&L.length>0&&a("div",{className:"mb-6 p-4 bg-red-50 rounded-xl text-red-800",children:[e("div",{className:"font-semibold mb-2",children:"Issues found:"}),e("ul",{className:"list-disc pl-6 space-y-1",children:L.map((t,s)=>e("li",{children:t},s))})]}),m.length===0?a("div",{className:"text-center py-12",children:[e("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No marksheets found"}),e("p",{className:"text-gray-600",children:"Import student marks to generate marksheets"})]}):x?a("div",{className:"space-y-4",children:[a("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-6",children:[a("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[a("button",{onClick:()=>D(null),className:"inline-flex items-center gap-2 px-3 py-2 text-blue-600 hover:text-blue-800 font-medium transition-colors text-sm sm:text-base",children:[e("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Examinations"]}),e("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:x}),a("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs sm:text-sm font-semibold whitespace-nowrap",children:[((B=M[x])==null?void 0:B.length)||0," marksheets"]})]}),a("div",{className:"flex gap-2 sm:gap-3 flex-wrap",children:[e("button",{onClick:J,disabled:w||N(x),className:`inline-flex items-center gap-2 px-3 sm:px-5 py-2 sm:py-3 rounded-xl font-semibold text-xs sm:text-sm transition-all duration-200 whitespace-nowrap ${w||N(x)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 hover:-translate-y-0.5 hover:shadow-md"}`,children:N(x)?"âœ“ All Verified":w?"Verifying...":"Verify All"}),e("button",{onClick:oe,disabled:w||N(x),className:`inline-flex items-center gap-2 px-3 sm:px-5 py-2 sm:py-3 rounded-xl font-semibold text-xs sm:text-sm transition-all duration-200 whitespace-nowrap ${w||N(x)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700 hover:-translate-y-0.5 hover:shadow-md"}`,children:N(x)?"âœ“ All Verified":w?"Processing...":"Verify & Request"})]})]}),(W=M[x])==null?void 0:W.map(t=>{var s,r;return a("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200 transform transition-all duration-200 hover:-translate-y-0.5 hover:shadow-md hover:border-gray-300",children:[a("div",{className:"flex items-start justify-between mb-4",children:[e("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 break-words flex-1 pr-4",children:((s=t.studentDetails)==null?void 0:s.name)||"Unknown student"}),a("span",{className:`px-2 py-0.5 sm:px-3 sm:py-1 rounded-full text-xs font-semibold uppercase tracking-wide flex items-center gap-0.5 sm:gap-1 flex-shrink-0 whitespace-nowrap ${F[t.status]||"bg-gray-100 text-gray-700"}`,children:[e("span",{className:"text-xs sm:text-sm",children:se[t.status]||"ðŸ“„"}),e("span",{className:"text-xs",children:(t.status||"unknown").replace(/_/g," ")})]})]}),a("div",{className:"space-y-3 mb-4",children:[a("p",{className:"text-gray-600 text-xs sm:text-sm",children:[((r=t.studentDetails)==null?void 0:r.regNumber)||"â€”"," â€¢ Class ",(()=>{var u,k;const i=(((u=t.studentDetails)==null?void 0:u.year)||"").toString(),o=(((k=t.studentDetails)==null?void 0:k.section)||"").toString();return i&&o?`${i}-${o}`:i||o||"â€”"})()]}),a("p",{className:"text-xs sm:text-sm text-gray-500",children:["Overall Result: ",e("span",{className:"font-semibold text-gray-900",children:ye(t)})]})]}),e("div",{children:e("button",{onClick:()=>y(`/marksheets/${t._id||t.marksheetId}`),className:"text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-medium",children:"View Details"})})]},t._id)})]}):a("div",{className:"space-y-4",children:[e("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Examinations"}),Object.keys(M).map(t=>{const s=M[t],r=s.length,i=s.reduce((o,u)=>(o[u.status]=(o[u.status]||0)+1,o),{});return e("div",{onClick:()=>D(t),className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200 cursor-pointer transform transition-all duration-200 hover:-translate-y-0.5 hover:shadow-md hover:border-yellow-300 hover:bg-yellow-50",children:a("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a("div",{className:"flex-1",children:[e("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:t}),a("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-6 text-xs sm:text-sm text-gray-600",children:[a("span",{className:"font-medium",children:["Total: ",e("span",{className:"text-blue-600 font-semibold",children:r})," marksheets"]}),e("div",{className:"flex flex-wrap items-center gap-3",children:Object.entries(i).map(([o,u])=>{var k;return a("span",{className:"flex items-center gap-1 whitespace-nowrap",children:[e("span",{className:`w-2 h-2 sm:w-3 sm:h-3 rounded-full ${(k=F[o])!=null&&k.includes("bg-")?F[o].split(" ")[0]:"bg-gray-300"}`}),a("span",{className:"capitalize text-xs sm:text-sm",children:[o.replace(/_/g," "),": ",u]})]},o)})})]})]}),e("div",{className:"self-end sm:self-auto text-right",children:e("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},t)})]})]})]})}),e(h,{}),e(E,{})]})}export{Ve as default};
