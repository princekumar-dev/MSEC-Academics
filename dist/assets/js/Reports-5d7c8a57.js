import{j as e,a as t,F as N}from"./index-d35fa7e7.js";import{r as u}from"./react-vendor-07fa9950.js";import{H as C}from"./ContextualHelp-7deaab06.js";import{d as L,a as W}from"./resultUtils-190b400a.js";function F(){const[p,z]=u.useState(()=>{const s=localStorage.getItem("auth");return s?JSON.parse(s):null}),[i,x]=u.useState(!1),[c,S]=u.useState([]),[a,g]=u.useState(null),[y,f]=u.useState(""),[k,j]=u.useState("");u.useEffect(()=>{(p==null?void 0:p.role)==="hod"&&M()},[p]);const M=async()=>{try{x(!0);const r=await(await fetch(`/api/marksheets?department=${p.department}&includeAll=true`)).json();if(r.success){const o=r.marksheets.sort((d,n)=>{var h,b;const m=(((h=d.studentDetails)==null?void 0:h.regNumber)||"").toString().toLowerCase(),l=(((b=n.studentDetails)==null?void 0:b.regNumber)||"").toString().toLowerCase();return m.localeCompare(l,void 0,{numeric:!0,sensitivity:"base"})});S(o)}}catch(s){console.error("Error fetching marksheets:",s),f("Failed to fetch department data")}finally{x(!1)}},D=()=>{const s={},r={},o=c.filter(l=>l.status==="dispatched").length,d=c.filter(l=>l.status==="approved_by_hod"||l.status==="dispatch_requested").length,n=c.filter(l=>l.status==="rejected_by_hod").length;c.forEach(l=>{var v;const h=((v=l.studentDetails)==null?void 0:v.year)||"Unknown";s[h]||(s[h]=0),s[h]++;const b=L(l);r[b]||(r[b]=0),r[b]++});const m={totalStudents:c.length,totalMarksheets:c.length,byStatus:{dispatched:o,pending:d,rejected:n},byYear:s,overallResults:r};g({type:"department_summary",data:m})},R=()=>{const s={};c.forEach(r=>{var l,h;const o=((l=r.studentDetails)==null?void 0:l.year)||"Unknown",d=((h=r.studentDetails)==null?void 0:h.section)||"Unknown",n=o&&d?`${o}-${d}`:`Class ${o}`;s[n]||(s[n]={year:o,section:d,totalStudents:0,dispatched:0,pending:0,dispatchRate:0,resultDistribution:{}}),s[n].totalStudents++,r.status==="dispatched"?s[n].dispatched++:(r.status==="approved_by_hod"||r.status==="dispatch_requested")&&s[n].pending++;const m=L(r);s[n].resultDistribution[m]||(s[n].resultDistribution[m]=0),s[n].resultDistribution[m]++}),Object.values(s).forEach(r=>{r.dispatchRate=r.totalStudents>0?(r.dispatched/r.totalStudents*100).toFixed(1):0}),g({type:"classwise_performance",data:s})},_=()=>{const s=c.filter(r=>r.status==="rejected_by_hod"||r.status==="approved_by_hod"&&new Date(r.updatedAt)<new Date(Date.now()-6048e5)).map(r=>{var o,d,n,m;return{studentName:((o=r.studentDetails)==null?void 0:o.name)||"Unknown",registerNumber:((d=r.studentDetails)==null?void 0:d.registerNumber)||"Unknown",branch:((n=r.studentDetails)==null?void 0:n.branch)||"Unknown",year:((m=r.studentDetails)==null?void 0:m.year)||"Unknown",dispatchAttempts:r.dispatchAttempts||1,lastDispatchAttempt:r.updatedAt||new Date}});g({type:"failed_dispatches",data:s})},B=()=>{const s={};c.forEach(r=>{var o;(o=r.subjects)==null||o.forEach(d=>{const n=d.subjectName,m=d.subjectCode||"N/A";s[n]||(s[n]={subjectName:n,subjectCode:m,totalEnrollments:0,passCount:0,passRate:0,failCount:0,failRate:0,absentCount:0,absentRate:0,totalMarks:0,marksCount:0,highest:0,lowest:1/0,average:0});const l=s[n],h=W(d),b=Number(d.marks),v=!Number.isNaN(b);l.totalEnrollments++,h==="Pass"?l.passCount++:h==="Fail"?l.failCount++:h==="Absent"?l.absentCount++:l.passCount++,v&&(l.totalMarks+=b,l.marksCount++,l.highest=Math.max(l.highest,b),l.lowest=Math.min(l.lowest,b))})}),Object.values(s).forEach(r=>{r.passRate=r.totalEnrollments>0?r.passCount/r.totalEnrollments*100:0,r.failRate=r.totalEnrollments>0?r.failCount/r.totalEnrollments*100:0,r.absentRate=r.totalEnrollments>0?r.absentCount/r.totalEnrollments*100:0,r.average=r.marksCount>0?r.totalMarks/r.marksCount:0,r.marksCount===0?(r.highest=0,r.lowest=0):Number.isFinite(r.lowest)||(r.lowest=0)}),g({type:"subject_analysis",data:s})},w=async s=>{if(!a){alert("Please generate a report first");return}try{x(!0);const o={type:{department_summary:"department-summary",classwise_performance:"classwise-performance",failed_dispatches:"failed-dispatches",subject_analysis:"subject-analysis"}[a.type]||a.type,data:a.data,format:s,department:p.department,generatedBy:p.name||p.email,generatedAt:new Date().toISOString(),metadata:{totalRecords:Array.isArray(a.data)?a.data.length:a.data.totalStudents||Object.keys(a.data).length,reportTitle:E(a.type),departmentName:p.department}},d=await fetch("/api/export-reports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!d.ok)throw new Error(`Export failed: ${d.status}`);const n=await d.blob(),m=window.URL.createObjectURL(n),l=document.createElement("a");l.href=m;const h=s==="excel"?"xlsx":s,b=`${a.type}_${p.department}_${new Date().toISOString().split("T")[0]}.${h}`;l.download=b,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(m),j(`Report exported successfully as ${s.toUpperCase()}`),setTimeout(()=>j(""),3e3)}catch(r){console.error("Export error:",r),f(`Failed to export report: ${r.message}`),setTimeout(()=>f(""),5e3)}finally{x(!1)}},E=s=>({department_summary:"Department Summary Report",classwise_performance:"Class-wise Performance Report",failed_dispatches:"Failed Dispatches Report",subject_analysis:"Subject-wise Analysis Report"})[s]||"Report";return!p||p.role!=="hod"?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:t("div",{className:"glass-card p-8 rounded-3xl text-center",children:[e("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e("p",{className:"text-gray-600",children:"Only HODs can generate reports."})]})}):e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 no-mobile-anim",children:e("div",{className:"responsive-container py-6 md:py-8",children:t("div",{className:"max-w-7xl mx-auto",children:[e("div",{className:"mb-6 md:mb-8",children:e("div",{className:"glass-card no-mobile-backdrop responsive-spacing rounded-3xl",children:t("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[t("div",{children:[e("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-black text-[#111418] mb-2",children:"Report Management"}),t("p",{className:"text-base sm:text-lg text-gray-600",children:["Generate and export reports for ",p.department," Department"]})]}),e("div",{className:"flex flex-wrap items-center gap-3",children:t("div",{className:"glass-card px-3 py-2 rounded-xl",children:[e("div",{className:"text-xs text-gray-500",children:"Total Records"}),e("div",{className:"text-xl md:text-2xl font-bold text-theme-gold-600",children:c.length})]})})]})})}),t("div",{className:"glass-card responsive-spacing rounded-2xl md:rounded-3xl mb-6 md:mb-8",children:[y&&e("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:t("div",{className:"flex",children:[e("svg",{className:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e("div",{className:"text-red-800",children:y})]})}),k&&e("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:t("div",{className:"flex",children:[e("svg",{className:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e("div",{className:"text-green-800",children:k})]})}),i&&e("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:t("div",{className:"flex items-center",children:[e("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-2"}),e("div",{className:"text-blue-800",children:"Loading department data..."})]})}),c.length>0&&t("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 mb-6 md:mb-8",children:[e("div",{className:"responsive-card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-blue-600 font-medium mb-1",children:"Total"}),e("p",{className:"text-2xl md:text-3xl font-bold text-blue-700",children:c.length})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})]})}),e("div",{className:"responsive-card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-green-600 font-medium mb-1",children:"Dispatched"}),e("p",{className:"text-2xl md:text-3xl font-bold text-green-700",children:c.filter(s=>s.status==="dispatched").length})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e("div",{className:"responsive-card bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-yellow-600 font-medium mb-1",children:"Pending"}),e("p",{className:"text-2xl md:text-3xl font-bold text-yellow-700",children:c.filter(s=>["approved_by_hod","dispatch_requested"].includes(s.status)).length})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e("div",{className:"responsive-card bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-red-600 font-medium mb-1",children:"Rejected"}),e("p",{className:"text-2xl md:text-3xl font-bold text-red-700",children:c.filter(s=>s.status==="rejected_by_hod").length})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})})]}),t("div",{className:"responsive-grid responsive-grid-2 lg:grid-cols-3",children:[t("div",{className:"responsive-card group hover:shadow-xl transition-all duration-300 bg-white border-2 border-blue-100 hover:border-blue-300",children:[t("div",{className:"flex items-start justify-between mb-4",children:[e("div",{className:"p-3 bg-blue-100 rounded-xl group-hover:bg-blue-200 transition-colors",children:e("svg",{className:"w-6 h-6 md:w-7 md:h-7 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:"Overview"})]}),t("div",{className:"flex items-center gap-2 mb-2",children:[e("h3",{className:"text-base md:text-lg font-bold text-gray-900",children:"Department Summary"}),e(C,{content:"Shows overall statistics including status breakdown, year-wise distribution, and pass/fail/absent analysis for all marksheets."})]}),e("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:"Complete overview with status breakdown, year-wise stats, and result distribution"}),e("button",{onClick:D,disabled:i,className:"responsive-button w-full bg-blue-600 text-white hover:bg-white hover:text-blue-600 hover:border-2 hover:border-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?t("span",{className:"flex items-center justify-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):"Generate Report"})]}),t("div",{className:"responsive-card group hover:shadow-xl transition-all duration-300 bg-white border-2 border-green-100 hover:border-green-300",children:[t("div",{className:"flex items-start justify-between mb-4",children:[e("div",{className:"p-3 bg-green-100 rounded-xl group-hover:bg-green-200 transition-colors",children:e("svg",{className:"w-6 h-6 md:w-7 md:h-7 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),e("span",{className:"text-xs font-semibold text-green-600 bg-green-50 px-2 py-1 rounded-full",children:"Performance"})]}),e("h3",{className:"text-base md:text-lg font-bold text-gray-900 mb-2",children:"Class-wise Analysis"}),e("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:"Detailed breakdown by year/section with dispatch rates and result distribution"}),e("button",{onClick:R,disabled:i,className:"responsive-button w-full bg-green-600 text-white hover:bg-white hover:text-green-600 hover:border-2 hover:border-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?t("span",{className:"flex items-center justify-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):"Generate Report"})]}),t("div",{className:"responsive-card group hover:shadow-xl transition-all duration-300 bg-white border-2 border-red-100 hover:border-red-300",children:[t("div",{className:"flex items-start justify-between mb-4",children:[e("div",{className:"p-3 bg-red-100 rounded-xl group-hover:bg-red-200 transition-colors",children:e("svg",{className:"w-6 h-6 md:w-7 md:h-7 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e("span",{className:"text-xs font-semibold text-red-600 bg-red-50 px-2 py-1 rounded-full",children:"Issues"})]}),e("h3",{className:"text-base md:text-lg font-bold text-gray-900 mb-2",children:"Failed Dispatches"}),e("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:"Marksheets with failed dispatch attempts or pending for over 7 days"}),e("button",{onClick:_,disabled:i,className:"responsive-button w-full bg-red-600 text-white hover:bg-white hover:text-red-600 hover:border-2 hover:border-red-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?t("span",{className:"flex items-center justify-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):"View Issues"})]}),t("div",{className:"responsive-card group hover:shadow-xl transition-all duration-300 bg-white border-2 border-yellow-100 hover:border-yellow-300",children:[t("div",{className:"flex items-start justify-between mb-4",children:[e("div",{className:"p-3 bg-yellow-100 rounded-xl group-hover:bg-yellow-200 transition-colors",children:e("svg",{className:"w-6 h-6 md:w-7 md:h-7 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e("span",{className:"text-xs font-semibold text-yellow-600 bg-yellow-50 px-2 py-1 rounded-full",children:"Tracking"})]}),e("h3",{className:"text-base md:text-lg font-bold text-gray-900 mb-2",children:"Change History"}),e("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:"Track modifications in student details, phone numbers, grades, and marksheet data"}),e("button",{onClick:()=>alert("Change tracking feature coming soon!"),disabled:i,className:"responsive-button w-full bg-yellow-600 text-white hover:bg-white hover:text-yellow-600 hover:border-2 hover:border-yellow-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?t("span",{className:"flex items-center justify-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):"View Changes"})]}),t("div",{className:"responsive-card group hover:shadow-xl transition-all duration-300 bg-white border-2 border-purple-100 hover:border-purple-300",children:[t("div",{className:"flex items-start justify-between mb-4",children:[e("div",{className:"p-3 bg-purple-100 rounded-xl group-hover:bg-purple-200 transition-colors",children:e("svg",{className:"w-6 h-6 md:w-7 md:h-7 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e("span",{className:"text-xs font-semibold text-purple-600 bg-purple-50 px-2 py-1 rounded-full",children:"Analytics"})]}),t("div",{className:"flex items-center gap-2 mb-2",children:[e("h3",{className:"text-base md:text-lg font-bold text-gray-900 mb-2",children:"Subject Analysis"}),e(C,{content:"Performance metrics for each subject with pass rate, fail rate, and absent rate"})]}),e("p",{className:"text-sm text-gray-600 mb-4",children:"Performance metrics for each subject with pass rate, fail rate, and absent rate."}),e("button",{onClick:B,disabled:i,className:"responsive-button w-full bg-purple-600 text-white hover:bg-white hover:text-purple-600 hover:border-2 hover:border-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?t("span",{className:"flex items-center justify-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):"Generate Report"})]}),t("div",{className:"responsive-card group hover:shadow-xl transition-all duration-300 bg-white border-2 border-indigo-100 hover:border-indigo-300",children:[t("div",{className:"flex items-start justify-between mb-4",children:[e("div",{className:"p-3 bg-indigo-100 rounded-xl group-hover:bg-indigo-200 transition-colors",children:e("svg",{className:"w-6 h-6 md:w-7 md:h-7 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}),e("span",{className:"text-xs font-semibold text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full",children:"Custom"})]}),e("h3",{className:"text-base md:text-lg font-bold text-gray-900 mb-2",children:"Custom Report Builder"}),e("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:"Create tailored reports with specific filters, date ranges, and custom criteria"}),e("button",{onClick:()=>alert("Custom report builder coming soon!"),disabled:i,className:"responsive-button w-full bg-indigo-600 text-white hover:bg-white hover:text-indigo-600 hover:border-2 hover:border-indigo-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:i?t("span",{className:"flex items-center justify-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):"Create Custom"})]})]}),a&&t("div",{className:"mt-6 md:mt-8 responsive-card bg-white border-2 border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200",children:[t("div",{children:[t("h3",{className:"responsive-heading-2 text-gray-900 mb-1",children:[a.type==="department_summary"&&"Department Summary",a.type==="classwise_performance"&&"Class-wise Performance",a.type==="failed_dispatches"&&"Failed Dispatches",a.type==="subject_analysis"&&"Subject Analysis"]}),t("p",{className:"text-xs md:text-sm text-gray-500",children:["Generated on ",new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e("div",{className:"p-2 bg-theme-gold-100 rounded-lg",children:e("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-theme-gold-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),a.type==="department_summary"&&t("div",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[e("div",{className:"responsive-card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 hover:shadow-lg transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-blue-600 font-medium mb-1",children:"Total"}),e("p",{className:"text-2xl md:text-3xl font-bold text-blue-700",children:a.data.totalStudents})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})]})}),e("div",{className:"responsive-card bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-lg transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-green-600 font-medium mb-1",children:"Dispatched"}),e("p",{className:"text-2xl md:text-3xl font-bold text-green-700",children:a.data.byStatus.dispatched})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e("div",{className:"responsive-card bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200 hover:shadow-lg transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-yellow-600 font-medium mb-1",children:"Pending"}),e("p",{className:"text-2xl md:text-3xl font-bold text-yellow-700",children:a.data.byStatus.pending})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e("div",{className:"responsive-card bg-gradient-to-br from-red-50 to-red-100 border-red-200 hover:shadow-lg transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-xs md:text-sm text-red-600 font-medium mb-1",children:"Rejected"}),e("p",{className:"text-2xl md:text-3xl font-bold text-red-700",children:a.data.byStatus.rejected})]}),e("svg",{className:"w-8 h-8 md:w-10 md:h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[t("div",{className:"responsive-card bg-gradient-to-br from-indigo-50 to-indigo-100 border-indigo-200",children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e("svg",{className:"w-5 h-5 text-indigo-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e("h4",{className:"text-base md:text-lg font-bold text-indigo-900 leading-none",children:"Year-wise Distribution"})]}),e("div",{className:"space-y-3",children:a.data.byYear&&Object.entries(a.data.byYear).map(([s,r])=>t("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg hover:shadow-md transition-shadow",children:[t("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),t("span",{className:"text-sm md:text-base font-medium text-gray-700",children:["Year ",s]})]}),e("span",{className:"text-base md:text-lg font-bold text-indigo-600",children:r})]},s))})]}),t("div",{className:"responsive-card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e("h4",{className:"text-base md:text-lg font-bold text-purple-900",children:"Result Distribution"})]}),e("div",{className:"space-y-3",children:a.data.overallResults&&Object.entries(a.data.overallResults).map(([s,r])=>t("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg hover:shadow-md transition-shadow",children:[t("div",{className:"flex items-center gap-2",children:[e("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e("span",{className:"text-sm md:text-base font-medium text-gray-700",children:s})]}),e("span",{className:"text-base md:text-lg font-bold text-purple-600",children:r})]},s))})]})]})]}),a.type==="failed_dispatches"&&t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center gap-2 p-4 bg-red-50 rounded-lg border border-red-200",children:[e("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t("div",{children:[t("p",{className:"text-sm md:text-base font-semibold text-red-900",children:["Found ",a.data.length," marksheets with issues"]}),e("p",{className:"text-xs md:text-sm text-red-700",children:"These marksheets may have failed dispatch or are pending for over 7 days"})]})]}),a.data.length===0?t("div",{className:"responsive-card bg-green-50 border-green-200 text-center py-8",children:[e("svg",{className:"w-12 h-12 text-green-500 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e("p",{className:"text-base md:text-lg font-semibold text-green-900",children:"No Failed Dispatches!"}),e("p",{className:"text-sm text-green-700 mt-1",children:"All marksheets are processing normally"})]}):e("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:a.data.map((s,r)=>e("div",{className:"responsive-card bg-white border-2 border-red-100 hover:border-red-300 hover:shadow-lg transition-all",children:t("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t("div",{className:"flex items-start gap-3",children:[e("div",{className:"p-2 bg-red-100 rounded-lg flex-shrink-0",children:e("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t("div",{children:[e("h5",{className:"text-sm md:text-base font-bold text-gray-900",children:s.studentName}),t("p",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[e("span",{className:"font-medium",children:"Reg No:"})," ",s.registerNumber]}),t("p",{className:"text-xs text-gray-500 mt-1",children:["Year ",s.year," â€¢ ",s.branch]}),s.dispatchAttempts>1&&t("p",{className:"text-xs text-red-600 mt-1 font-medium",children:[s.dispatchAttempts," dispatch attempts"]})]})]}),t("div",{className:"flex flex-col items-end gap-1",children:[e("span",{className:"text-xs font-semibold text-red-600 bg-red-100 px-2 py-1 rounded-full",children:"Failed"}),e("p",{className:"text-xs text-gray-500",children:new Date(s.lastDispatchAttempt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})},r))})]}),a.type==="subject_analysis"&&e("div",{className:"space-y-4",children:e("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:a.data&&Object.entries(a.data).map(([s,r],o)=>t("div",{className:"responsive-card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200 hover:shadow-lg transition-all",children:[t("div",{className:"flex items-center gap-2 mb-4",children:[e("div",{className:"p-2 bg-purple-200 rounded-lg",children:e("svg",{className:"w-5 h-5 text-purple-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),t("div",{className:"flex-1",children:[e("h5",{className:"text-sm md:text-base font-bold text-purple-900",children:s}),t("p",{className:"text-xs text-purple-700",children:["Subject Code: ",r.subjectCode]})]}),t("span",{className:"text-xs font-semibold text-purple-600 bg-purple-200 px-2 py-1 rounded-full",children:[r.totalEnrollments," Students"]})]}),t("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Average"}),e("p",{className:"text-lg md:text-xl font-bold text-purple-700",children:r.average.toFixed(1)})]}),t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Highest"}),e("p",{className:"text-lg md:text-xl font-bold text-green-600",children:r.highest})]}),t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Lowest"}),e("p",{className:"text-lg md:text-xl font-bold text-red-600",children:r.lowest})]}),t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Pass Rate"}),t("p",{className:"text-lg md:text-xl font-bold text-blue-600",children:[r.passRate.toFixed(1),"%"]})]})]})]},s))})}),a.type==="classwise_performance"&&e("div",{className:"space-y-4",children:e("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:a.data&&Object.entries(a.data).map(([s,r])=>t("div",{className:"responsive-card bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-lg transition-all",children:[t("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[t("div",{className:"flex items-center gap-3",children:[e("div",{className:"p-2 bg-green-200 rounded-lg",children:e("svg",{className:"w-5 h-5 text-green-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t("div",{children:[t("h5",{className:"text-base md:text-lg font-bold text-green-900",children:["Class ",s]}),t("p",{className:"text-xs md:text-sm text-green-700",children:["Year ",r.year," - Section ",r.section]})]})]}),t("div",{className:"flex gap-2",children:[t("span",{className:"text-xs font-semibold text-green-600 bg-green-200 px-3 py-1 rounded-full",children:[r.totalStudents," Students"]}),t("span",{className:"text-xs font-semibold text-blue-600 bg-blue-100 px-3 py-1 rounded-full",children:[r.dispatchRate,"% Dispatched"]})]})]}),t("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 mb-4",children:[t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Total"}),e("p",{className:"text-lg md:text-xl font-bold text-green-700",children:r.totalStudents})]}),t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Dispatched"}),e("p",{className:"text-lg md:text-xl font-bold text-blue-600",children:r.dispatched})]}),t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs text-gray-500 mb-1",children:"Pending"}),e("p",{className:"text-lg md:text-xl font-bold text-yellow-600",children:r.pending})]})]}),r.resultDistribution&&Object.keys(r.resultDistribution).length>0&&t("div",{className:"bg-white p-3 rounded-lg",children:[e("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Result Distribution"}),e("div",{className:"flex flex-wrap gap-2",children:Object.entries(r.resultDistribution).map(([o,d])=>t("span",{className:"text-xs font-medium bg-gradient-to-r from-green-100 to-green-200 text-green-800 px-3 py-1 rounded-full",children:[o,": ",d]},o))})]})]},s))})})]}),t("div",{className:"mt-6 md:mt-8 responsive-card bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200",children:[t("div",{className:"flex items-center gap-3 mb-4",children:[e("div",{className:"p-2 bg-blue-100 rounded-lg",children:e("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),t("div",{children:[e("h4",{className:"text-base md:text-lg font-bold text-blue-900",children:"Export Report"}),e("p",{className:"text-xs md:text-sm text-blue-700",children:"Download in your preferred format"})]})]}),t("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e("button",{onClick:()=>w("pdf"),disabled:!a||i,className:"responsive-button flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500 disabled:border-gray-300 bg-blue-600 text-white hover:bg-white hover:text-blue-600 hover:border-2 hover:border-blue-600",children:i?e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):t(N,{children:[e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e("span",{className:"hidden sm:inline",children:"PDF"}),e("span",{className:"sm:hidden",children:"Export PDF"})]})}),e("button",{onClick:()=>w("excel"),disabled:!a||i,className:"responsive-button flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500 disabled:border-gray-300 bg-green-600 text-white hover:bg-white hover:text-green-600 hover:border-2 hover:border-green-600",children:i?e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):t(N,{children:[e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e("span",{className:"hidden sm:inline",children:"Excel"}),e("span",{className:"sm:hidden",children:"Export Excel"})]})}),e("button",{onClick:()=>w("csv"),disabled:!a||i,className:"responsive-button flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500 disabled:border-gray-300 bg-gray-700 text-white hover:bg-white hover:text-gray-700 hover:border-2 hover:border-gray-700",children:i?e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):t(N,{children:[e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e("span",{className:"hidden sm:inline",children:"CSV"}),e("span",{className:"sm:hidden",children:"Export CSV"})]})})]}),!a&&t("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg flex items-start gap-2",children:[e("svg",{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e("p",{className:"text-sm text-blue-800",children:"Generate a report first to enable export options"})]}),i&&t("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg flex items-center gap-2",children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e("p",{className:"text-sm text-blue-800",children:"Processing your export request..."})]})]})]})]})})})}export{F as default};
